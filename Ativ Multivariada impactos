#############################################################
# Atividade final de disciplina de Estatistica Multivariada #
# Ideia de protocolo para avaliar impactos ambientais
##########################

#primeiro vou criar amostras de dados no R
rnorm(n,media,desvio)

setwd(C:/R/)
ambi<-read.csv(" .csv", row.names=1)
espa<-read.csv("
sp<-read.csv("

# Grafico d riqueza de especies por unidadea amostral espacial:
library(vegan)

# Add riqueza d sp.
riqueza<-specnumber(spe) #função do pacote q calcula riqueza através dos dados brutos

plot(spa$X, spa$Y, type="n", ylim=c(20,120),    #função concatenar foi usada p ...
xlab= "Coordenada X(km)", ylab= "Coordenada Y(km)", las=1) +
lines(spa$X, spa$Y, col="blue4") +
points(spa$X, spa$Y, cex=riqueza/3.5,pch=16, col="gray") +   #add círculos de riqueza (dividiu por 3.5 pois riqueza ficava muito grande no grafico)
points(spa$X, spa$Y, cex=riqueza/3.5,pch=1) +   #add bordas, permite vermos as sobreposições dos círculos
points(spa$X, spa$Y, cex=0.5, pch=16)   #add centros

## Calcular cluster por Bray-Curtis:
# 1-Não precisa transformar(especies), precisa nos fisico-quimicos (mas nele use matriz euclidiana)
# 2-Calcular Matriz
spe.bray <-vegdist(spe_8, method="bray")
# 3-Calcular cluster
cluster1<-hclust(spe.bray, method="average")
# 4-Coeficiente de correlação cofenética
cluster1.coph<-cophenetic(cluster1)
cor(spe.bray, cluster1.coph)
# 5-Visualizar cluster
spe.bray.dend<-as.dendrogram(cluster1)
plot(spe.bray.dend, horiz=T) 
## Calcular Jaccard:
# method="jaccard", binary=TRUE nos argumentos

#padronizar dados

# criar e escolher matriz de distancia

#calcular coeficiente de correlaçao cofenetico

#criar cluster com matriz de melhor coeficiente (

#criar mapa de calor

#fazer ordenaçao dos dados para avaliar as mudanças das caracteristicas fisico-quimicas

#dividir dados em area diretamente e indiretamente impactada

#há autocorrelaçao espacial? A q dostancia os resultados passam a 
